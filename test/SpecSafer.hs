{-|
Description : test.
Copyright   : (c) Jörg K.-H. W. Brüggmann, 2021-2022
License     : proprietary, to be dual licensed
Maintainer  : info@joerg-brueggmann.de
Stability   : experimental
Portability : POSIX
-}

{-# LANGUAGE BinaryLiterals #-}

module SpecSafer
    (
        testGroup
    ) where

import qualified Test.Tasty as T
import qualified Test.Tasty.QuickCheck as QC
import qualified Test.Tasty.HUnit as HU

import qualified Data.Word as W

import qualified Safer as Sfr

testGroup :: T.TestTree
testGroup = 
    T.testGroup 
        "Safer" 
        [
            tgShiftR, 
            tgShiftL
        ]

tgShiftR :: T.TestTree
tgShiftR = 
    T.testGroup 
        ".>>" 
        [
            HU.testCase  "#1"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>> (-2) ) HU.@?= 0b0110100110010110100101100110100110010110011010010110100110010110 ), 
            HU.testCase  "#2"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>> (-1) ) HU.@?= 0b0110100110010110100101100110100110010110011010010110100110010110 ), 
            HU.testCase  "#3"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>    0 ) HU.@?= 0b0110100110010110100101100110100110010110011010010110100110010110 ), 
            HU.testCase  "#4"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>    1 ) HU.@?= 0b0011010011001011010010110011010011001011001101001011010011001011 ), 
            HU.testCase  "#5"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>    2 ) HU.@?= 0b0001101001100101101001011001101001100101100110100101101001100101 ), 
            HU.testCase  "#6"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>    3 ) HU.@?= 0b0000110100110010110100101100110100110010110011010010110100110010 ), 
            HU.testCase  "#7"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>   60 ) HU.@?= 0b0000000000000000000000000000000000000000000000000000000000000110 ), 
            HU.testCase  "#8"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>   61 ) HU.@?= 0b0000000000000000000000000000000000000000000000000000000000000011 ), 
            HU.testCase  "#9"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>   62 ) HU.@?= 0b0000000000000000000000000000000000000000000000000000000000000001 ), 
            HU.testCase "#10"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>   63 ) HU.@?= 0b0000000000000000000000000000000000000000000000000000000000000000 ), 
            HU.testCase "#11"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>   64 ) HU.@?= 0b0000000000000000000000000000000000000000000000000000000000000000 ), 
            HU.testCase "#12"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr..>>   65 ) HU.@?= 0b0000000000000000000000000000000000000000000000000000000000000000 )
        ]

tgShiftL :: T.TestTree
tgShiftL = 
    T.testGroup 
        "<<." 
        [
            HU.testCase  "#1"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<. (-2) ) HU.@?= 0b0110100110010110100101100110100110010110011010010110100110010110 ), 
            HU.testCase  "#2"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<. (-1) ) HU.@?= 0b0110100110010110100101100110100110010110011010010110100110010110 ), 
            HU.testCase  "#3"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.    0 ) HU.@?= 0b0110100110010110100101100110100110010110011010010110100110010110 ), 
            HU.testCase  "#4"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.    1 ) HU.@?= 0b1101001100101101001011001101001100101100110100101101001100101100 ), 
            HU.testCase  "#5"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.    2 ) HU.@?= 0b1010011001011010010110011010011001011001101001011010011001011000 ), 
            HU.testCase  "#6"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.    3 ) HU.@?= 0b0100110010110100101100110100110010110011010010110100110010110000 ), 
            HU.testCase  "#7"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.   60 ) HU.@?= 0b0110000000000000000000000000000000000000000000000000000000000000 ), 
            HU.testCase  "#8"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.   61 ) HU.@?= 0b1100000000000000000000000000000000000000000000000000000000000000 ), 
            HU.testCase  "#9"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.   62 ) HU.@?= 0b1000000000000000000000000000000000000000000000000000000000000000 ), 
            HU.testCase "#10"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.   63 ) HU.@?= 0b0000000000000000000000000000000000000000000000000000000000000000 ), 
            HU.testCase "#11"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.   64 ) HU.@?= 0b0000000000000000000000000000000000000000000000000000000000000000 ), 
            HU.testCase "#12"  (( (0b0110100110010110100101100110100110010110011010010110100110010110::W.Word64) Sfr.<<.   65 ) HU.@?= 0b0000000000000000000000000000000000000000000000000000000000000000 )
        ]
